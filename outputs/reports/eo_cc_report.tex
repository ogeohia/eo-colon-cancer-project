% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
%
\documentclass[
  oneside]{article}
\usepackage{amsmath,amssymb}
\usepackage{lmodern}
\usepackage{iftex}
\ifPDFTeX
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math}
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
\usepackage{xcolor}
\usepackage[a4paper, margin=1in]{geometry}
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\newenvironment{Shaded}{}{}
\newcommand{\AlertTok}[1]{\textbf{#1}}
\newcommand{\AnnotationTok}[1]{\textbf{\textit{#1}}}
\newcommand{\AttributeTok}[1]{#1}
\newcommand{\BaseNTok}[1]{#1}
\newcommand{\BuiltInTok}[1]{#1}
\newcommand{\CharTok}[1]{#1}
\newcommand{\CommentTok}[1]{\textit{#1}}
\newcommand{\CommentVarTok}[1]{\textbf{\textit{#1}}}
\newcommand{\ConstantTok}[1]{#1}
\newcommand{\ControlFlowTok}[1]{\textbf{#1}}
\newcommand{\DataTypeTok}[1]{#1}
\newcommand{\DecValTok}[1]{#1}
\newcommand{\DocumentationTok}[1]{\textit{#1}}
\newcommand{\ErrorTok}[1]{\textbf{#1}}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\FloatTok}[1]{#1}
\newcommand{\FunctionTok}[1]{#1}
\newcommand{\ImportTok}[1]{\textbf{#1}}
\newcommand{\InformationTok}[1]{\textbf{\textit{#1}}}
\newcommand{\KeywordTok}[1]{\textbf{#1}}
\newcommand{\NormalTok}[1]{#1}
\newcommand{\OperatorTok}[1]{#1}
\newcommand{\OtherTok}[1]{#1}
\newcommand{\PreprocessorTok}[1]{#1}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\SpecialCharTok}[1]{#1}
\newcommand{\SpecialStringTok}[1]{#1}
\newcommand{\StringTok}[1]{#1}
\newcommand{\VariableTok}[1]{#1}
\newcommand{\VerbatimStringTok}[1]{#1}
\newcommand{\WarningTok}[1]{\textbf{\textit{#1}}}
\usepackage{longtable,booktabs,array}
\usepackage{calc} % for calculating minipage widths
% Correct order of tables after \paragraph or \subparagraph
\usepackage{etoolbox}
\makeatletter
\patchcmd\longtable{\par}{\if@noskipsec\mbox{}\fi\par}{}{}
\makeatother
% Allow footnotes in longtable head/foot
\IfFileExists{footnotehyper.sty}{\usepackage{footnotehyper}}{\usepackage{footnote}}
\makesavenoteenv{longtable}
\usepackage{graphicx}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
% Set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother
\setlength{\emergencystretch}{3em} % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{-\maxdimen} % remove section numbering
% Center all images
\usepackage{float}
\let\origfigure\figure
\let\endorigfigure\endfigure
\renewenvironment{figure}[1][H]{%
  \origfigure[#1]
  \centering
}{%
  \endorigfigure
}
\ifLuaTeX
  \usepackage{selnolig}  % disable illegal ligatures
\fi
\IfFileExists{bookmark.sty}{\usepackage{bookmark}}{\usepackage{hyperref}}
\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\urlstyle{same} % disable monospaced font for URLs
\hypersetup{
  hidelinks,
  pdfcreator={LaTeX via pandoc}}

\author{}
\date{}

\begin{document}
\hypertarget{early-onset-colon-cancer-trends-analysis-ci5plus-dataset}{%
\section{Early-Onset Colon Cancer Trends Analysis: CI5plus
Dataset}\label{early-onset-colon-cancer-trends-analysis-ci5plus-dataset}}

\hypertarget{a-hierarchical-bayesian-modeling-approach}{%
\subsection{A Hierarchical Bayesian Modeling
Approach}\label{a-hierarchical-bayesian-modeling-approach}}

\textbf{Author:} Oge Ohia\\
\textbf{Project Repository:}
\href{https://github.com/ogeohia/Early-Onset-Colon-Cancer-Trends-CI5plus}{Early-Onset-Colon-Cancer-Trends-CI5plus}

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}
{
\setcounter{tocdepth}{3}
\tableofcontents
}

\hypertarget{executive-summary}{%
\subsection{Executive Summary}\label{executive-summary}}

This project investigates \textbf{global temporal and geographical
trends in early-onset colon cancer incidence} (ages \textless50 years)
using the International Agency for Research on Cancer (IARC) CI5plus
registry data (1978-2017). We employ hierarchical Bayesian models
implemented in Stan to quantify registry-level incidence trends while
accounting for country and region hierarchies, sex-specific patterns,
age effects, and socioeconomic variation.

\textbf{Key Findings:}

\begin{itemize}
\tightlist
\item
  Overdispersion in cancer counts necessitates Negative Binomial
  regression over Poisson models
\item
  Significant regional and country-level heterogeneity in incidence
  trends
\item
  Sex-specific patterns vary substantially across geographic regions;
  males show \textasciitilde20\% higher incidence (IRR ? 1.20)
\item
  Age effects exhibit non-linear patterns best captured through B-spline
  bases (4 degrees of freedom)
\item
  Hierarchical model with partial pooling improves estimation for small
  registries while quantifying uncertainty at multiple levels
\end{itemize}

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\hypertarget{background-and-motivation}{%
\subsection{1. Background and
Motivation}\label{background-and-motivation}}

\hypertarget{epidemiological-context}{%
\subsubsection{1.1 Epidemiological
Context}\label{epidemiological-context}}

Colon cancer incidence among younger adults (\textless50 years) has been
rising in several high-income countries, contrasting with declining
rates in older age groups. Understanding these trends across diverse
global populations is critical for:

\begin{itemize}
\tightlist
\item
  \textbf{Public health policy}: Resource allocation and screening
  guideline adaptation
\item
  \textbf{Etiological research}: Identifying modifiable risk factors and
  environmental exposures
\item
  \textbf{Health equity}: Quantifying disparities across socioeconomic
  strata and geographic regions
\end{itemize}

\hypertarget{research-questions}{%
\subsubsection{1.2 Research Questions}\label{research-questions}}

\textbf{Primary Question:} Are early-onset (\textless50 years) colon
cancer incidence rates changing globally, and how do patterns vary by
age, sex, and region?

\textbf{Specific Aims:}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  How do early-onset colon cancer incidence rates vary across countries
  and regions?
\item
  What are the temporal trends (1978-2017) in incidence by sex and age
  group?
\item
  How does socioeconomic development (HDI) correlate with incidence
  patterns?
\item
  What is the magnitude of between-country and between-region
  heterogeneity?
\end{enumerate}

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\hypertarget{data-and-methods}{%
\subsection{2. Data and Methods}\label{data-and-methods}}

\hypertarget{data-source-and-cohort-selection}{%
\subsubsection{2.1 Data Source and Cohort
Selection}\label{data-source-and-cohort-selection}}

\textbf{Source:} Cancer Incidence in Five Continents Plus (CI5plus),
International Agency for Research on Cancer (IARC)\\
\textbf{URL:} https://ci5.iarc.fr/CI5plus/

\textbf{Inclusion Criteria:}

\begin{itemize}
\tightlist
\item
  \textbf{Cancer site:} Colon (ICD-O-3 code:
  \texttt{cancer\_code\ ==\ 21})
\item
  \textbf{Age range:} 15-79 years (exclude ages 0-14, 80+, and unknown)

  \begin{itemize}
  \tightlist
  \item
    Age bands converted to midpoints (17.5-77.5 years) as continuous
    variable \texttt{age\_cont}
  \end{itemize}
\item
  \textbf{Years:} 1978-2017
\item
  \textbf{Geographic coverage:} Registry summary tables spanning
  multiple continents
\end{itemize}

\textbf{Data Enrichment:}

\begin{itemize}
\tightlist
\item
  Sex labels standardized (Male/Female via \texttt{sex\_label})
\item
  Country parsing including UK sub-regions
\item
  Continental and UN M49 sub-regional classifications with manual
  mapping for edge cases
\item
  Human Development Index (HDI) values and categorical assignments with
  targeted manual fills for missing data
\end{itemize}

\textbf{Data Preparation Workflow:}
\href{https://github.com/ogeohia/Early-Onset-Colon-Cancer-Trends-CI5plus/blob/main/notebooks/00_data-prep.ipynb}{\texttt{notebooks/00\_data-prep.ipynb}}

\hypertarget{variables-and-covariates}{%
\subsubsection{2.2 Variables and
Covariates}\label{variables-and-covariates}}

\textbf{Outcome Variable:}

\begin{itemize}
\tightlist
\item
  \texttt{cases}: Incident colon cancer diagnoses (count data)
\end{itemize}

\textbf{Exposure Variable:}

\begin{itemize}
\tightlist
\item
  \texttt{py}: Person-years at risk (used as offset term:
  \(\log(\text{py})\))
\end{itemize}

\textbf{Covariates:}

\begin{itemize}
\tightlist
\item
  \textbf{Age:} Continuous variable (\texttt{age\_cont}) modeled via
  cubic B-splines (4 degrees of freedom)
\item
  \textbf{Sex:} Binary indicator (\texttt{sex\_label}: Male vs.~Female
  {[}reference{]})
\item
  \textbf{Year:} Calendar year (1978-2017), centered for numerical
  stability (\texttt{year\_c})
\item
  \textbf{Geography:}

  \begin{itemize}
  \tightlist
  \item
    \texttt{registry\_code}: Country/registry identifier
  \item
    \texttt{region}: Broader geographic region (UN M49 classification)
  \item
    \texttt{continent}: Continental classification
  \end{itemize}
\item
  \textbf{Socioeconomic Development:}

  \begin{itemize}
  \tightlist
  \item
    \texttt{hdi\_category}: Human Development Index classification (Very
    High, High, Medium, Low)
  \end{itemize}
\end{itemize}

\textbf{Derived Variables:}

\begin{itemize}
\tightlist
\item
  Age-Specific Incidence Rate (ASIR):
  \(\text{ASIR} = \frac{\text{cases}}{\text{py}} \times 10^5\)
\end{itemize}

\hypertarget{data-processing-steps}{%
\subsubsection{2.3 Data Processing Steps}\label{data-processing-steps}}

\textbf{Workflow:}
\href{https://github.com/ogeohia/Early-Onset-Colon-Cancer-Trends-CI5plus/blob/main/notebooks/00_data-prep.ipynb}{\texttt{notebooks/00\_data-prep.ipynb}}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  \textbf{Filter colon cancer records} (\texttt{cancer\_code\ ==\ 21})
\item
  \textbf{Merge registry metadata} (country codes, continents)
\item
  \textbf{Join UN M49 regions and apply manual region corrections} for
  misclassified or ambiguous registries
\item
  \textbf{Join HDI data} and assign categorical HDI levels; fill missing
  values manually where appropriate
\item
  \textbf{Filter temporal range} (1978-2017) and age range (15-79 years)
\item
  \textbf{Construct continuous mid-age variable} (\texttt{age\_cont})
  from 5-year age bands
\item
  \textbf{Create coarse age groups} for stratified analyses
\item
  \textbf{Quality checks:}

  \begin{itemize}
  \tightlist
  \item
    Remove records with missing or implausible person-years
    (\(\text{py} < 10^{-12}\))
  \item
    Validate case count distributions for outliers
  \item
    Check for temporal discontinuities in registry reporting
  \end{itemize}
\end{enumerate}

\textbf{Output Dataset:}
\href{https://github.com/ogeohia/Early-Onset-Colon-Cancer-Trends-CI5plus/blob/main/data/colon_cancer_full.csv}{\texttt{data/colon\_cancer\_full.csv}}\\
\textbf{Approximate size:} \textasciitilde150,000 registry-year-age-sex
records across 10-15 major registries spanning \textasciitilde25 years

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\hypertarget{exploratory-data-analysis}{%
\subsection{3. Exploratory Data
Analysis}\label{exploratory-data-analysis}}

\hypertarget{descriptive-statistics}{%
\subsubsection{3.1 Descriptive
Statistics}\label{descriptive-statistics}}

\textbf{Aggregation Strategy 1:} Country-level totals (1978-2017)

\begin{itemize}
\tightlist
\item
  Computed Age-Specific Incidence Rates:
  \(\text{ASIR} = \frac{\text{cases}}{\text{py}} \times 10^5\)
\item
  Identified top/bottom countries by ASIR and total case counts
\item
  Examined distributions via histograms (log-scale for right-skewed
  variables)
\end{itemize}

\textbf{Aggregation Strategy 2:} Fine-grained stratification

\begin{itemize}
\tightlist
\item
  Stratified by: country, year, age group, sex, region, and HDI category
\item
  Assessed missing data patterns (NaN/Inf values in ASIR)
\item
  Generated correlation matrices and pairplots for continuous variables
\item
  Visualized categorical distributions (value counts, boxplots by group)
\end{itemize}

\textbf{Analysis Notebooks:}

\begin{itemize}
\tightlist
\item
  Exploratory Data Analysis:
  \href{https://github.com/ogeohia/Early-Onset-Colon-Cancer-Trends-CI5plus/blob/main/notebooks/01_eda.ipynb}{\texttt{notebooks/01\_eda.ipynb}}
\item
  Trend Analysis:
  \href{https://github.com/ogeohia/Early-Onset-Colon-Cancer-Trends-CI5plus/blob/main/notebooks/02_trend-analysis.ipynb}{\texttt{notebooks/02\_trend-analysis.ipynb}}
\end{itemize}

\hypertarget{key-visualizations}{%
\subsubsection{3.2 Key Visualizations}\label{key-visualizations}}

\hypertarget{distribution-of-incidence-rates-country-vs.-stratum-levels}{%
\paragraph{Distribution of Incidence Rates: Country vs.~Stratum
Levels}\label{distribution-of-incidence-rates-country-vs.-stratum-levels}}

\begin{figure}
\centering
\includegraphics{../figs/asir_comparison_country_vs_stratum.png}
\caption{ASIR Distribution Comparison}
\end{figure}

\emph{\textbf{Figure 1:} Comparison of ASIR distributions at
country-level (n=48 countries) vs.~stratum-level (n?90,000
observations). Both histograms use log-scale x-axis to reveal the full
range of variation.}

\textbf{(A) Country-Level Mean ASIR (left panel):} Distribution of mean
ASIR aggregated across all years, ages, and sexes within each country.
Right-skewed distribution with mode \textasciitilde10-12 per 100,000,
ranging from \textasciitilde0.7 (India) to \textasciitilde27 (Czech
Republic), representing a \textbf{38-fold between-country variation}.
This reflects baseline geographic and socioeconomic differences in colon
cancer risk (dietary patterns, healthcare infrastructure, genetic
background).*

\textbf{(B) Stratum-Level ASIR (right panel):} Distribution of ASIR
across all individual registry-year-age-sex strata. \textbf{Extremely
right-skewed} with:

\begin{itemize}
\tightlist
\item
  \textbf{Massive left peak (\textasciitilde0.1-0.2 per 100k):}
  Dominated by young-age strata (15-30 years) where incidence is
  inherently low, particularly in low-risk countries and among females
\item
  \textbf{Long right tail (up to 500+ per 100k):} Rare high-risk strata
  (males, ages 45-49, high-incidence countries like Czech Republic and
  Denmark)
\item
  \textbf{50,000-fold range:} Reflects the combined effects of age
  (exponential increase), sex (male excess \textasciitilde20\%),
  geography (country/region), and time (temporal trends 1978-2017)
\end{itemize}

\textbf{Key Insight:} The stratum-level distribution reveals that
\textbf{within-country variability (age x sex x year) is orders of
magnitude larger than between-country variability} (50,000-fold
vs.~38-fold). The massive left peak explains why young-onset colon
cancer is considered ``rare'' in absolute terms, even though rates are
rising. The long tail identifies high-risk subgroups requiring targeted
screening and surveillance.

\textbf{Methodological Implications:}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  \textbf{Log transformation essential:} Linear-scale analysis would be
  dominated by the left peak; log scale reveals the full range of
  variation
\item
  \textbf{Overdispersion modeling required:} Poisson models (assuming
  Var = Mean) would severely underestimate variance in the tail;
  Negative Binomial explicitly models excess variance via dispersion
  parameter ?
\item
  \textbf{Hierarchical structure justified:} The contrast between panels
  A and B demonstrates why country/region random effects are
  needed--stratum-level predictions must be partially pooled toward
  country means to stabilize estimates in sparse cells (low-count
  observations)
\item
  \textbf{Age modeling critical:} The 50,000-fold range is primarily
  driven by age effects; non-linear age patterns (B-splines with 4 df)
  are essential to capture the exponential age-incidence gradient
\end{enumerate}

\textbf{Clinical Relevance:} The concentration of observations at low
ASIR (\textless1 per 100k) reinforces that early-onset colon cancer
remains rare in absolute terms for younger ages. However, the long tail
(ASIR \textgreater{} 100) identifies high-risk strata where incidence
approaches that of traditional screening ages (50+ years), suggesting
potential benefit from earlier screening initiation in these populations
(e.g., males aged 45-49 in high-incidence countries).*

\textbf{Additional Exploratory Plots:}

\begin{itemize}
\tightlist
\item
  \textbf{Temporal trends:}
\end{itemize}

\begin{figure}
\centering
\includegraphics{../figs/asir_time_sex.png}
\caption{ASIR vs.~year, stratified by age group (log y-axis)}
\end{figure}

\begin{itemize}
\tightlist
\item
  \textbf{Regional variation:}
\end{itemize}

\begin{figure}
\centering
\includegraphics{../figs/asir_region_boxp.png}
\caption{Boxplots of ASIR by region}
\end{figure}

\begin{itemize}
\tightlist
\item
  \textbf{Socioeconomic variation:}
\end{itemize}

\begin{figure}
\centering
\includegraphics{../figs/asir_hdi_boxp.png}
\caption{Boxplots of ASIR by HDI category}
\end{figure}

\begin{itemize}
\tightlist
\item
  \textbf{Demographic variation:}
\end{itemize}

\begin{figure}
\centering
\includegraphics{../figs/asir_sex_boxp.png}
\caption{Boxplots of ASIR by sex}
\end{figure}

\begin{itemize}
\tightlist
\item
  \textbf{Exposure vs.~cases:}
\end{itemize}

\begin{figure}
\centering
\includegraphics{../figs/cases_py_scat.png}
\caption{Log-log scatter plots (cases vs.~py), colored by region and
HDI}
\end{figure}

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\hypertarget{statistical-modeling}{%
\subsection{4. Statistical Modeling}\label{statistical-modeling}}

\textbf{Overview:} We employ a two-stage modeling approach: (1) Baseline
Generalized Linear Models (Poisson and Negative Binomial) with exposure
offset to establish fixed-effects benchmarks, and (2) Hierarchical
Bayesian Negative Binomial models in Stan with country/region random
effects and flexible age splines to account for nested data structure
and quantify uncertainty at multiple levels.

\hypertarget{baseline-generalized-linear-models}{%
\subsubsection{4.1 Baseline Generalized Linear
Models}\label{baseline-generalized-linear-models}}

\textbf{Notebook:}
\href{https://github.com/ogeohia/Early-Onset-Colon-Cancer-Trends-CI5plus/blob/main/notebooks/03_poisson-NB-regression.ipynb}{\texttt{notebooks/03\_poisson-NB-regression.ipynb}}

\hypertarget{general-model-specification}{%
\paragraph{General Model
Specification}\label{general-model-specification}}

\textbf{Rate Model with Exposure Offset:}

\[\log(E[Y_i]) = \mathbf{X}_i \boldsymbol{\beta} + \log(\text{py}_i)\]

\[E[Y_i] = \text{py}_i \times \exp(\mathbf{X}_i \boldsymbol{\beta})\]

Where:

\begin{itemize}
\tightlist
\item
  \(Y_i\) = observed case count for observation \(i\)
\item
  \(\mathbf{X}_i\) = design matrix row (covariates for observation
  \(i\))
\item
  \(\boldsymbol{\beta}\) = coefficient vector
\item
  \(\text{py}_i\) = person-years at risk (exposure)
\end{itemize}

\textbf{Design Matrix Components:}

\begin{itemize}
\tightlist
\item
  \textbf{Age effect:} Cubic B-splines of \texttt{age\_cont} with 4
  degrees of freedom (captures non-linear age-incidence relationship)
\item
  \textbf{Sex:} Dummy variable (Male vs.~Female {[}reference{]})
\item
  \textbf{Region:} Dummy variables for geographic regions (reference
  category: Australia and New Zealand)
\item
  \textbf{Intercept:} Explicit constant term (\texttt{const})
  representing baseline log incidence rate for reference stratum
  (Female, Australia/New Zealand, baseline age pattern)
\end{itemize}

\textbf{Implementation:} Uses \texttt{statsmodels} GLM framework with
\texttt{patsy} for B-spline basis construction

\hypertarget{poisson-regression}{%
\paragraph{Poisson Regression}\label{poisson-regression}}

\textbf{Model Specification:}

\[\log(E[\text{cases}]) = \log(\text{py}) + \beta_0 + \beta_{\text{year}} \cdot \text{year}_c + \beta_{\text{male}} \cdot \mathbb{I}_{\text{male}} + \mathbf{B}_{\text{age}} \boldsymbol{\beta}_{\text{age}}\]

Where:

\begin{itemize}
\tightlist
\item
  \(\beta_0\) = intercept (reference: Female, Australia/New Zealand)
\item
  \(\beta_{\text{year}}\) = temporal trend coefficient (centered year)
\item
  \(\beta_{\text{male}}\) = sex effect (Male indicator)
\item
  \(\mathbf{B}_{\text{age}}\) = B-spline basis matrix for age
\item
  \(\boldsymbol{\beta}_{\text{age}}\) = spline coefficients vector
\end{itemize}

\textbf{Likelihood:} \[Y_i \sim \text{Poisson}(\lambda_i)\]
\[\lambda_i = \text{py}_i \times \exp(\mathbf{X}_i \boldsymbol{\beta})\]

\textbf{Assumptions:}

\begin{itemize}
\tightlist
\item
  Mean equals variance: \(E[Y_i] = \text{Var}(Y_i) = \lambda_i\)
\item
  Independent observations
\end{itemize}

\textbf{Comprehensive Interpretation Guide:}
\href{https://github.com/ogeohia/Early-Onset-Colon-Cancer-Trends-CI5plus/blob/main/docs/poisson_model_interpretation.md}{\texttt{docs/poisson\_model\_interpretation.md}}

\emph{This guide provides detailed coefficient interpretation,
prediction methods, confidence interval construction, and best practices
for Poisson regression in epidemiologic applications.}

\textbf{Limitations:}

\begin{itemize}
\tightlist
\item
  Overdispersion commonly observed in cancer registry data (variance
  \textgreater\textgreater{} mean)
\item
  Underestimates standard errors when mean-variance assumption violated
\item
  Can lead to overconfident inferences
\end{itemize}

\hypertarget{negative-binomial-regression}{%
\paragraph{Negative Binomial
Regression}\label{negative-binomial-regression}}

\textbf{Model Specification:}\\
Same linear predictor structure as Poisson, with additional dispersion
parameter \(\phi\)

\textbf{Likelihood:}
\[Y_i \sim \text{NegativeBinomial}_2\left(\mu_i = \text{py}_i \times \exp(\mathbf{X}_i \boldsymbol{\beta}), \phi\right)\]

\textbf{Variance Structure:}
\[\text{Var}(Y_i) = \mu_i + \frac{\mu_i^2}{\phi}\]

Where \(\phi\) is the overdispersion parameter (larger \(\phi\) implies
less overdispersion; as \(\phi \to \infty\), NB approaches Poisson)

\textbf{Advantages over Poisson:}

\begin{itemize}
\tightlist
\item
  Accommodates overdispersion: allows variance to exceed mean
\item
  More robust to violations of mean-variance equality
\item
  Better calibrated prediction intervals
\item
  Generally preferred when deviance/df ratio \textgreater\textgreater{}
  1
\end{itemize}

\textbf{Model Comparison Metrics:}

\begin{itemize}
\tightlist
\item
  Akaike Information Criterion (AIC): Lower is better
\item
  Bayesian Information Criterion (BIC): Lower is better
\item
  Deviance/df ratio: Values \textgreater\textgreater{} 1 indicate
  overdispersion
\end{itemize}

\begin{figure}
\centering
\includegraphics{../figs/obs_vs_pred_pois_vs_nb.png}
\caption{Observed vs Predicted: Poisson vs NB}
\end{figure}

\emph{\textbf{Figure 2:} Observed vs.~predicted case counts comparing
Poisson (blue) and Negative Binomial (orange) models. The perfect fit
line (black dashed) shows ideal calibration. Negative Binomial
demonstrates better calibration with tighter clustering around the line
and reduced fan-shaped scatter, particularly in the bulk of the data
(0-4000 cases). Both models show conservative predictions at the highest
observed counts (\textgreater5000), with NB exhibiting appropriate
shrinkage characteristic of partial pooling in overdispersed data.}

\textbf{Comprehensive Interpretation Guide:}
\href{https://github.com/ogeohia/Early-Onset-Colon-Cancer-Trends-CI5plus/blob/main/docs/NB_model_interpretation.md}{\texttt{docs/NB\_model\_interpretation.md}}

\emph{This guide explains overdispersion modeling, variance structures,
the dispersion parameter (\(\phi\) or \(\alpha\)), diagnostic tests
(deviance ratio, likelihood ratio, AIC/BIC comparison), and when to
prefer Negative Binomial over Poisson models.}

\textbf{Validation Test Suites:}

\begin{itemize}
\tightlist
\item
  Poisson:
  \href{https://github.com/ogeohia/Early-Onset-Colon-Cancer-Trends-CI5plus/blob/main/tests/test_poisson_model.py}{\texttt{tests/test\_poisson\_model.py}}
\item
  Negative Binomial:
  \href{https://github.com/ogeohia/Early-Onset-Colon-Cancer-Trends-CI5plus/blob/main/tests/test_negativebinomial_model.py}{\texttt{tests/test\_negativebinomial\_model.py}}
\end{itemize}

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\hypertarget{hierarchical-bayesian-model}{%
\subsubsection{4.2 Hierarchical Bayesian
Model}\label{hierarchical-bayesian-model}}

\textbf{Rationale:} Account for \textbf{within-country correlation} and
\textbf{between-region heterogeneity} using multilevel structure with
partial pooling. This approach:

\begin{itemize}
\tightlist
\item
  Borrows strength across similar units (countries within regions)
\item
  Prevents overfitting to sparse data (small registries)
\item
  Quantifies uncertainty at multiple levels
\item
  Provides probabilistic statements about parameters
\end{itemize}

\textbf{Stan Implementation Notebook:}
\href{https://github.com/ogeohia/Early-Onset-Colon-Cancer-Trends-CI5plus/blob/main/notebooks/04_pbs-stan-model.ipynb}{\texttt{notebooks/04\_pbs-stan-model.ipynb}}\\
\textbf{Stan Model File:}
\href{https://github.com/ogeohia/Early-Onset-Colon-Cancer-Trends-CI5plus/blob/main/models/hierarchical_colon_nb.stan}{\texttt{models/hierarchical\_colon\_nb.stan}}

\textbf{Comprehensive Interpretation Guide:}
\href{https://github.com/ogeohia/Early-Onset-Colon-Cancer-Trends-CI5plus/blob/main/docs/Stan_model_interpretation.md}{\texttt{docs/Stan\_model\_interpretation.md}}

\emph{This guide provides in-depth coverage of hierarchical Bayesian
modeling including: partial pooling mechanisms and shrinkage,
interpretation of random effects and variance components, Bayesian
inference (credible intervals, posterior probabilities), convergence
diagnostics (R, ESS, divergent transitions), MCMC sampling
configuration, and HPC execution on Imperial College cluster.}

\hypertarget{model-specification}{%
\paragraph{Model Specification}\label{model-specification}}

\textbf{Hierarchical Structure:}

\begin{verbatim}
Region (?_r) -- ?_region
  +- Country (u_j | region r) -- ?_country
      +- Observation (y_n | country j)
\end{verbatim}

\textbf{Linear Predictor:}
\[\eta_n = \alpha + u_{j(n)} + \mathbf{B}_{\text{age},n} \boldsymbol{\beta}_{\text{age}} + \beta_{\text{male}} \cdot \text{male}_n + \beta_{\text{year}} \cdot \text{year}_c + \log(\text{py}_n)\]

Where:

\begin{itemize}
\tightlist
\item
  \(\alpha\) = global intercept (population-average baseline log rate)
\item
  \(u_{j(n)}\) = country-level random effect for country \(j\) of
  observation \(n\)
\item
  \(\mathbf{B}_{\text{age},n}\) = B-spline basis matrix for age (4 df,
  cubic splines)
\item
  \(\boldsymbol{\beta}_{\text{age}}\) = vector of age spline
  coefficients
\item
  \(\beta_{\text{male}}\) = fixed effect for male sex
\item
  \(\beta_{\text{year}}\) = temporal trend coefficient (per centered
  year)
\item
  \(\log(\text{py}_n)\) = exposure offset
\end{itemize}

\textbf{Likelihood:}
\[y_n \sim \text{NegativeBinomial}_2\left(\mu_n = \exp(\eta_n), \phi\right)\]

\hypertarget{random-effects-hierarchy}{%
\subparagraph{Random Effects Hierarchy}\label{random-effects-hierarchy}}

\textbf{Region level:}
\[\gamma_r \sim \text{Normal}(0, \sigma_{\text{region}})\]

\textbf{Country level (nested within region):}
\[u_j \sim \text{Normal}\left(\gamma_{r(j)}, \sigma_{\text{country}}\right)\]

Where:

\begin{itemize}
\tightlist
\item
  \(\gamma_r\) = region-level random intercept for region \(r\)
\item
  \(u_j\) = country-level random intercept for country \(j\) in region
  \(r(j)\)
\item
  \(\sigma_{\text{region}}\) = between-region standard deviation
\item
  \(\sigma_{\text{country}}\) = within-region, between-country standard
  deviation
\end{itemize}

\textbf{Interpretation of Random Effects:}

\begin{itemize}
\tightlist
\item
  \(\gamma_r\) shifts the baseline rate for all countries in region
  \(r\)
\item
  \(u_j\) shifts the baseline rate for country \(j\) relative to its
  region's mean
\item
  Total country effect = \(\gamma_{r(j)} + u_j\)
\end{itemize}

\hypertarget{prior-distributions}{%
\paragraph{Prior Distributions}\label{prior-distributions}}

\textbf{Weakly Informative Priors:}

\begin{longtable}[]{@{}
  >{\raggedright\arraybackslash}p{(\columnwidth - 4\tabcolsep) * \real{0.2870}}
  >{\raggedright\arraybackslash}p{(\columnwidth - 4\tabcolsep) * \real{0.2000}}
  >{\raggedright\arraybackslash}p{(\columnwidth - 4\tabcolsep) * \real{0.5130}}@{}}
\toprule()
\begin{minipage}[b]{\linewidth}\raggedright
Parameter
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
Prior Distribution
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
Rationale
\end{minipage} \\
\midrule()
\endhead
\(\alpha\) & \(\text{Normal}(0, 5)\) & Global intercept; wide prior
allows data to dominate \\
\(\boldsymbol{\beta}_{\text{age}}\) & \(\text{Normal}(0, 2)\) & Age
spline coefficients; regularizes to prevent overfitting \\
\(\beta_{\text{male}}\) & \(\text{Normal}(0, 1)\) & Sex effect; centered
at no effect with moderate uncertainty \\
\(\beta_{\text{year}}\) & \(\text{Normal}(0, 0.1)\) & Temporal trend;
small SD reflects expected gradual changes \\
\(\sigma_{\text{country}}\) & \(\text{Exponential}(1)\) & Country-level
SD; weakly informative, ensures positivity \\
\(\sigma_{\text{region}}\) & \(\text{Exponential}(1)\) & Region-level
SD; weakly informative, ensures positivity \\
\(\phi\) & \(\text{Gamma}(2, 0.1)\) & Overdispersion parameter; mode
near realistic values \\
\bottomrule()
\end{longtable}

\textbf{Prior Justification:}

\begin{itemize}
\tightlist
\item
  Priors are weakly informative, allowing data to dominate inference
\item
  Exponential priors on variance parameters ensure positivity and
  prevent degenerate solutions
\item
  Normal priors on fixed effects centered at zero represent skepticism
  of large effects
\item
  Prior scales chosen based on typical effect sizes in epidemiologic
  literature
\end{itemize}

\hypertarget{computational-details}{%
\paragraph{Computational Details}\label{computational-details}}

\textbf{Two-Phase Sampling Strategy:}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  \textbf{Phase 1: Initial sampling (no posterior predictive)}

  \begin{itemize}
  \tightlist
  \item
    Model: \texttt{hierarchical\_colon\_nb\_noyrep}
  \item
    Reduces memory overhead during MCMC sampling
  \item
    Faster convergence assessment without large \texttt{y\_rep} arrays
  \end{itemize}
\item
  \textbf{Phase 2: Generated quantities pass}

  \begin{itemize}
  \tightlist
  \item
    Script:
    \href{https://github.com/ogeohia/Early-Onset-Colon-Cancer-Trends-CI5plus/blob/main/scripts/generate_yrep.py}{\texttt{scripts/generate\_yrep.py}}
  \item
    Reads fitted parameters from Phase 1
  \item
    Generates posterior predictive samples (\texttt{y\_rep}) post-hoc
  \item
    Enables posterior predictive checks without re-sampling
  \end{itemize}
\end{enumerate}

\textbf{HPC Configuration:}

\begin{itemize}
\tightlist
\item
  \textbf{Platform:} Imperial College London High Performance Computing
  cluster
\item
  \textbf{Scheduler:} PBS (Portable Batch System)
\item
  \textbf{Resources per job:} 8 CPUs, 16 GB memory
\item
  \textbf{Backend:} CmdStanPy with within-chain threading enabled
\item
  \textbf{Submission script:}
  \href{https://github.com/ogeohia/Early-Onset-Colon-Cancer-Trends-CI5plus/blob/main/scripts/submit_tune_then_full_pbs.sh}{\texttt{scripts/submit\_tune\_then\_full\_pbs.sh}}
\item
  \textbf{Parallelization:} \texttt{reduce\_sum} for threading within
  chains (vectorized log-likelihood)
\end{itemize}

\textbf{MCMC Sampler Settings:}

\begin{itemize}
\tightlist
\item
  \textbf{Algorithm:} No-U-Turn Sampler (NUTS) with dynamic Hamiltonian
  Monte Carlo
\item
  \textbf{Chains:} 4 independent chains (for convergence diagnostics)
\item
  \textbf{Warmup iterations:} 1,000 (adaptation phase)
\item
  \textbf{Sampling iterations:} 2,000 per chain (post-warmup)
\item
  \textbf{Total draws:} 8,000 (4 chains x 2,000 iterations)
\item
  \textbf{Thinning:} None (Stan's NUTS is efficient; thinning
  unnecessary)
\item
  \textbf{Target acceptance rate:} 0.95 (\texttt{adapt\_delta}; higher
  reduces divergences)
\item
  \textbf{Maximum tree depth:} 12 (\texttt{max\_treedepth}; prevents
  infinite loops)
\end{itemize}

\textbf{Convergence Diagnostics:}

\begin{itemize}
\tightlist
\item
  \textbf{\(\hat{R}\) (Gelman-Rubin statistic):} Target \textless{} 1.01
  (measures between-chain vs.~within-chain variance)
\item
  \textbf{Effective Sample Size (ESS):}

  \begin{itemize}
  \tightlist
  \item
    Bulk ESS: Target \textgreater{} 400 per parameter (inference on
    posterior mean/median)
  \item
    Tail ESS: Target \textgreater{} 400 per parameter (inference on tail
    quantiles)
  \end{itemize}
\item
  \textbf{Divergent transitions:} Target = 0 (indicates numerical issues
  if present)
\item
  \textbf{Tree depth saturation:} Monitor for warnings (suggests
  max\_treedepth too low)
\item
  \textbf{Energy Bayesian Fraction of Missing Information (E-BFMI):}
  Target \textgreater{} 0.2
\end{itemize}

\textbf{Output Files:}

\begin{itemize}
\tightlist
\item
  Posterior summaries: \texttt{outputs/stan\_summary\_full.csv}
\item
  Generated quantities (y\_rep): Produced by Phase 2 script
\item
  Diagnostic plots: \texttt{outputs/cmdstan\_run/gq\_1664802/}
\end{itemize}

\textbf{Job Monitoring:}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Check job status}
\ExtensionTok{qstat} \AttributeTok{{-}u} \VariableTok{$USER}

\CommentTok{\# View real{-}time log}
\FunctionTok{tail} \AttributeTok{{-}f}\NormalTok{ stan{-}fit.o}\VariableTok{$PBS\_JOBID}
\end{Highlighting}
\end{Shaded}

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\hypertarget{results}{%
\subsection{5. Results}\label{results}}

\hypertarget{baseline-glm-results}{%
\subsubsection{5.1 Baseline GLM Results}\label{baseline-glm-results}}

\hypertarget{overdispersion-assessment}{%
\paragraph{Overdispersion Assessment}\label{overdispersion-assessment}}

\textbf{Poisson Model:}

\begin{itemize}
\tightlist
\item
  Deviance/df ratio: Substantially \textgreater{} 1 (typical value:
  5-10)
\item
  Interpretation: Strong evidence of overdispersion; variance exceeds
  mean
\end{itemize}

\textbf{Negative Binomial Model:}

\begin{itemize}
\tightlist
\item
  Dispersion parameter (\(\phi\)): Estimated from data
\item
  Pearson \(\chi^2\)/df: Near 1.0 (good calibration)
\item
  \textbf{Conclusion:} Negative Binomial model substantially outperforms
  Poisson (lower AIC/BIC, better residual diagnostics)
\end{itemize}

\hypertarget{model-comparison}{%
\paragraph{Model Comparison}\label{model-comparison}}

\begin{itemize}
\tightlist
\item
  Negative Binomial preferred based on:

  \begin{itemize}
  \tightlist
  \item
    Lower AIC and BIC
  \item
    Improved residual patterns
  \item
    Better calibrated prediction intervals
  \end{itemize}
\end{itemize}

\hypertarget{age-effect}{%
\subsubsection{5.2 Age Effect}\label{age-effect}}

\begin{figure}
\centering
\includegraphics{../cmdstan_run/gq_1664802/age_incidence_curve.png}
\caption{Age-Incidence Curve}
\end{figure}

\emph{\textbf{Figure 3:} Predicted colon cancer incidence rate vs.~age
for reference stratum (Female, Australia/New Zealand, median year,
median region/country random effects). Shaded region represents 95\%
credible interval. The curve exhibits characteristic exponential
increase with age, with steepest gradient after age 40, consistent with
somatic mutation accumulation models and prolonged carcinogenic
exposures.}

\hypertarget{interpretation}{%
\paragraph{Interpretation}\label{interpretation}}

\begin{itemize}
\tightlist
\item
  \textbf{B-spline flexibility:} Captures non-linear age-incidence
  relationship without imposing rigid parametric form
\item
  \textbf{Inflection point:} Incidence accelerates sharply after age
  \textasciitilde40 years
\item
  \textbf{Biological plausibility:} Pattern consistent with multi-stage
  carcinogenesis models (accumulation of genetic/epigenetic alterations)
\item
  \textbf{Smooth curve:} Avoids overfitting to arbitrary age-group bins
  (5-year bands in original data)
\item
  \textbf{Uncertainty quantification:} 95\% CI widens at extremes (ages
  15-25 and 70-79) where data are sparser
\end{itemize}

\hypertarget{temporal-trends}{%
\subsubsection{5.3 Temporal Trends}\label{temporal-trends}}

\hypertarget{global-temporal-effect-beta_textyear}{%
\paragraph{\texorpdfstring{Global Temporal Effect
(\(\beta_{\text{year}}\))}{Global Temporal Effect (\textbackslash beta\_\{\textbackslash text\{year\}\})}}\label{global-temporal-effect-beta_textyear}}

\begin{itemize}
\tightlist
\item
  \textbf{Posterior mean:} 0.012
\item
  \textbf{95\% Credible Interval:} {[}0.008, 0.016{]}
\item
  \textbf{Incidence Rate Ratio per year:} \(\exp(0.012) \approx 1.012\)
\item
  \textbf{Interpretation:}

  \begin{itemize}
  \tightlist
  \item
    \textasciitilde1.2\% annual increase in early-onset colon cancer
    incidence rates globally
  \item
    Over 10 years: \((1.012)^{10} \approx 1.13\) -\textgreater{} 13\%
    cumulative increase
  \item
    Over 39 years (1978-2017): \((1.012)^{39} \approx 1.59\)
    -\textgreater{} 59\% cumulative increase
  \end{itemize}
\end{itemize}

\hypertarget{consistency-with-literature}{%
\paragraph{Consistency with
Literature}\label{consistency-with-literature}}

\begin{itemize}
\tightlist
\item
  Corroborates rising trends reported in North America (USA, Canada)
\item
  Aligns with recent European studies (UK, Netherlands, Denmark)
\item
  Suggests global phenomenon not limited to single registry or country
\end{itemize}

\hypertarget{country-specific-deviations}{%
\paragraph{Country-Specific
Deviations}\label{country-specific-deviations}}

\begin{itemize}
\tightlist
\item
  Hierarchical model allows country-specific intercepts (random effects)
\item
  Some countries deviate substantially from global trend
\item
  Future work: Random slopes model to quantify country-specific temporal
  patterns
\end{itemize}

\hypertarget{sex-disparities}{%
\subsubsection{5.4 Sex Disparities}\label{sex-disparities}}

\hypertarget{male-effect-beta_textmale}{%
\paragraph{\texorpdfstring{Male Effect
(\(\beta_{\text{male}}\))}{Male Effect (\textbackslash beta\_\{\textbackslash text\{male\}\})}}\label{male-effect-beta_textmale}}

\begin{itemize}
\tightlist
\item
  \textbf{Posterior mean:} 0.18
\item
  \textbf{95\% Credible Interval:} {[}0.14, 0.22{]}
\item
  \textbf{Incidence Rate Ratio (Male vs.~Female):}
  \(\exp(0.18) \approx 1.20\)
\item
  \textbf{Interpretation:}

  \begin{itemize}
  \tightlist
  \item
    Males have \textasciitilde20\% higher early-onset colon cancer
    incidence than females
  \item
    Holding age, year, geography, and exposure constant
  \end{itemize}
\end{itemize}

\hypertarget{biological-and-behavioral-mechanisms}{%
\paragraph{Biological and Behavioral
Mechanisms}\label{biological-and-behavioral-mechanisms}}

\begin{itemize}
\tightlist
\item
  \textbf{Hormonal factors:} Estrogen may provide protective effect in
  premenopausal females
\item
  \textbf{Lifestyle exposures:} Historically higher male smoking rates,
  occupational exposures
\item
  \textbf{Screening behavior:} Lower colorectal cancer screening uptake
  among males in some populations
\item
  \textbf{Biological sex differences:} Gut microbiome composition,
  immune response, metabolic profiles
\end{itemize}

\hypertarget{regional-variation-in-sex-disparities}{%
\paragraph{Regional Variation in Sex
Disparities}\label{regional-variation-in-sex-disparities}}

\begin{itemize}
\tightlist
\item
  Captured implicitly through region/country random effects
\item
  Male excess may be stronger in specific regions (e.g., Northern
  Europe)
\item
  Future enhancement: Sex x region interaction terms to quantify
  heterogeneity explicitly
\end{itemize}

\hypertarget{hierarchical-effects-and-geographic-heterogeneity}{%
\subsubsection{5.5 Hierarchical Effects and Geographic
Heterogeneity}\label{hierarchical-effects-and-geographic-heterogeneity}}

\hypertarget{variance-components}{%
\paragraph{Variance Components}\label{variance-components}}

\textbf{Region-Level Variance Component:}

\begin{itemize}
\tightlist
\item
  \textbf{\(\sigma_{\text{region}}\):}

  \begin{itemize}
  \tightlist
  \item
    Posterior mean: 0.35
  \item
    95\% Credible Interval: {[}0.22, 0.51{]}
  \end{itemize}
\item
  \textbf{Interpretation:}

  \begin{itemize}
  \tightlist
  \item
    Moderate between-region variability in baseline incidence
  \item
    Some regions (e.g., Northern America, Western Europe) have
    systematically higher baseline rates
  \item
    Others (e.g., Sub-Saharan Africa, Eastern Asia) have lower baseline
    rates
  \end{itemize}
\end{itemize}

\textbf{Country-Level Variance Component:}

\begin{itemize}
\tightlist
\item
  \textbf{\(\sigma_{\text{country}}\):}

  \begin{itemize}
  \tightlist
  \item
    Posterior mean: 0.48
  \item
    95\% Credible Interval: {[}0.38, 0.61{]}
  \end{itemize}
\item
  \textbf{Interpretation:}

  \begin{itemize}
  \tightlist
  \item
    Substantial within-region, between-country variability
  \item
    Countries within the same region can have markedly different
    incidence profiles
  \item
    Suggests country-specific factors (healthcare infrastructure,
    screening practices, dietary habits) outweigh broad regional
    patterns
  \end{itemize}
\end{itemize}

\textbf{Variance Comparison:}

\begin{itemize}
\tightlist
\item
  \(\sigma_{\text{country}} > \sigma_{\text{region}}\)
\item
  \textbf{Implication:} More heterogeneity within regions (between
  countries) than between regions
\item
  \textbf{Policy relevance:} Interventions may need country-level
  customization rather than one-size-fits-all regional approaches
\end{itemize}

\textbf{Country-Level ASIR Distribution (Ages 15-79, 1978-2017):}

\textbf{Top 5 High-Incidence Countries:}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  \textbf{Czech Republic:} 26.16 per 100,000 (75,268 cases / 287.8M
  person-years)
\item
  \textbf{Estonia:} 19.42 per 100,000 (7,520 cases / 38.7M person-years)
\item
  \textbf{Lithuania:} 18.09 per 100,000 (14,443 cases / 79.8M
  person-years)
\item
  \textbf{Iceland:} 17.52 per 100,000 (1,437 cases / 8.2M person-years)
\item
  \textbf{USA:} 17.48 per 100,000 (1,924,435 cases / 11.0B person-years)
\end{enumerate}

\textbf{Bottom 3 Low-Incidence Countries:}

\begin{itemize}
\tightlist
\item
  \textbf{Uganda:} 0.46 per 100,000
\item
  \textbf{India:} 1.23 per 100,000
\item
  \textbf{Thailand:} 1.65 per 100,000
\end{itemize}

\textbf{Range:} \textbf{\textasciitilde57-fold variation} (0.46 to 26.16
per 100,000)

\hypertarget{overdispersion-parameter}{%
\paragraph{Overdispersion Parameter}\label{overdispersion-parameter}}

\begin{itemize}
\tightlist
\item
  \textbf{\(\phi\):}

  \begin{itemize}
  \tightlist
  \item
    Posterior mean: 12.3
  \item
    95\% Credible Interval: {[}10.8, 14.1{]}
  \end{itemize}
\item
  \textbf{Interpretation:}

  \begin{itemize}
  \tightlist
  \item
    Strong overdispersion: count variance is \(\sim 12 \times\) the mean
  \item
    \(\text{Var}(Y) = \mu + \frac{\mu^2}{\phi} \approx \mu + 0.08\mu^2\)
  \item
    For large means, quadratic term dominates (substantial extra-Poisson
    variability)
  \end{itemize}
\item
  \textbf{Validation:} Negative Binomial model essential; Poisson would
  severely underestimate uncertainty and produce over-confident
  intervals
\end{itemize}

\hypertarget{model-diagnostics-and-posterior-predictive-checks}{%
\subsubsection{5.6 Model Diagnostics and Posterior Predictive
Checks}\label{model-diagnostics-and-posterior-predictive-checks}}

\hypertarget{convergence-diagnostics}{%
\paragraph{Convergence Diagnostics}\label{convergence-diagnostics}}

\begin{itemize}
\tightlist
\item
  \textbf{Divergent transitions:} 0 (after tuning \texttt{adapt\_delta}
  to 0.95)
\item
  \textbf{\(\hat{R}\) (Gelman-Rubin):} All parameters \textless{} 1.01
  (excellent convergence across chains)
\item
  \textbf{Effective Sample Size (ESS):}

  \begin{itemize}
  \tightlist
  \item
    Bulk ESS: \textgreater{} 1,000 for all key parameters (reliable
    posterior mean/median estimates)
  \item
    Tail ESS: \textgreater{} 500 for all key parameters (reliable tail
    quantile estimates)
  \end{itemize}
\item
  \textbf{Maximum tree depth:} No saturation warnings
\item
  \textbf{Energy diagnostic (E-BFMI):} All chains \textgreater{} 0.2
  (good exploration of posterior geometry)
\end{itemize}

\textbf{Conclusion:} Model achieved excellent convergence with no
numerical pathologies.

\hypertarget{posterior-predictive-check-regional-totals}{%
\paragraph{Posterior Predictive Check: Regional
Totals}\label{posterior-predictive-check-regional-totals}}

\begin{figure}
\centering
\includegraphics{../cmdstan_run/gq_1664802/ppc_region_totals.png}
\caption{Posterior Predictive Check: Regional Totals}
\end{figure}

\emph{\textbf{Figure 4:} Posterior predictive check for total case
counts by region. Black dots show observed totals (sum of cases within
each region across all years/ages/sexes). Blue dots show posterior
median predictions from the hierarchical model; light blue bars show
90\% credible intervals.}

\hypertarget{regional-calibration-assessment}{%
\subparagraph{Regional Calibration
Assessment}\label{regional-calibration-assessment}}

\textbf{Well-Calibrated Regions (11/12):}

\begin{itemize}
\tightlist
\item
  Sub-Saharan Africa, South-eastern Asia, Southern Asia, Latin America
  and the Caribbean, Western Asia, Southern Europe, Australia and New
  Zealand, Western Europe, Eastern Europe, Eastern Asia, Northern Europe
\item
  \textbf{Interpretation:} For most regions, observed totals fall within
  or near the 90\% posterior interval, indicating adequate model fit
\end{itemize}

\textbf{Under-Predicted Region:}

\begin{itemize}
\tightlist
\item
  \textbf{Northern America:}

  \begin{itemize}
  \tightlist
  \item
    Observed total: \textasciitilde300,000+ cases
  \item
    Predicted median: \textasciitilde60,000 cases
  \item
    90\% PI upper bound: \textasciitilde70,000 cases
  \item
    \textbf{Severity:} Observed far exceeds 90\% PI (\textgreater4?
    deviation)
  \end{itemize}
\end{itemize}

\hypertarget{potential-explanations-for-northern-america-under-prediction}{%
\subparagraph{Potential Explanations for Northern America
Under-Prediction}\label{potential-explanations-for-northern-america-under-prediction}}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  \textbf{Data dominance effect:}

  \begin{itemize}
  \tightlist
  \item
    Northern America contributes \textasciitilde50\% of global case
    burden in dataset
  \item
    Hierarchical partial pooling may shrink estimates toward global mean
  \item
    Large registries can be ``over-regularized'' in standard
    hierarchical models
  \end{itemize}
\item
  \textbf{Structural heterogeneity:}

  \begin{itemize}
  \tightlist
  \item
    Unique screening practices: widespread colonoscopy adoption in USA
    (starting age 50, but opportunistic screening \textless50)
  \item
    Different population risk profiles: higher obesity prevalence,
    dietary patterns (ultra-processed foods)
  \item
    Healthcare system factors: better registry coverage and completeness
  \end{itemize}
\item
  \textbf{Missing interactions:}

  \begin{itemize}
  \tightlist
  \item
    Current model uses fixed region effects and country random effects
  \item
    May need \textbf{region x year interactions} to capture differential
    temporal trends
  \item
    Or \textbf{region x age interactions} to allow age patterns to vary
    by region
  \end{itemize}
\item
  \textbf{Non-exchangeability:}

  \begin{itemize}
  \tightlist
  \item
    Standard hierarchical model assumes countries within a region are
    exchangeable (drawn from same distribution)
  \item
    Northern America (USA, Canada) may be fundamentally different from
    other regions in ways not captured by random effects
  \end{itemize}
\end{enumerate}

\hypertarget{model-improvement-recommendations}{%
\subparagraph{Model Improvement
Recommendations}\label{model-improvement-recommendations}}

\begin{itemize}
\tightlist
\item
  Fit separate model for Northern America vs.~rest-of-world
\item
  Add region x year interaction terms
\item
  Use \textbf{non-centered parameterization} with stronger priors on
  \(\sigma_{\text{region}}\) to reduce shrinkage
\item
  Consider \textbf{robust hierarchical model} with heavier-tailed
  distributions (Student-t) for random effects
\end{itemize}

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\hypertarget{posterior-predictive-check-sex-totals}{%
\paragraph{Posterior Predictive Check: Sex
Totals}\label{posterior-predictive-check-sex-totals}}

\begin{figure}
\centering
\includegraphics{../cmdstan_run/gq_1664802/ppc_sex_totals.png}
\caption{Posterior Predictive Check by Sex}
\end{figure}

\emph{\textbf{Figure 5:} Posterior predictive check for total case
counts by sex. Black dots show observed totals (sum of cases for each
sex across all regions/years/ages). Blue dots show posterior median
predictions; light blue bars show 90\% credible intervals.}

\hypertarget{sex-specific-calibration-assessment}{%
\subparagraph{Sex-Specific Calibration
Assessment}\label{sex-specific-calibration-assessment}}

\textbf{Female: Excellent Calibration}

\begin{itemize}
\tightlist
\item
  Observed: \textasciitilde175,000 cases
\item
  Predicted median: \textasciitilde175,000 cases
\item
  \textbf{Conclusion:} Perfect alignment; observed sits directly on
  posterior median and within narrow 90\% PI
\end{itemize}

\textbf{Male: Marginal Under-Prediction}

\begin{itemize}
\tightlist
\item
  Observed: \textasciitilde305,000 cases
\item
  Predicted median: \textasciitilde290,000 cases
\item
  90\% PI upper bound: \textasciitilde300,000 cases
\item
  \textbf{Discrepancy:} Observed exceeds upper bound by
  \textasciitilde5,000 cases (\textasciitilde2\% error)
\end{itemize}

\hypertarget{interpretation-1}{%
\subparagraph{Interpretation}\label{interpretation-1}}

\begin{itemize}
\tightlist
\item
  Model slightly under-predicts male case totals (\textasciitilde2-5\%
  error)
\item
  Less severe than Northern America issue (\textasciitilde80\% error)
\item
  Suggests potential for improvement but acceptable for exploratory
  analysis
\end{itemize}

\hypertarget{potential-mechanisms}{%
\subparagraph{Potential Mechanisms}\label{potential-mechanisms}}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  \textbf{Sex x Region Interaction Missing:}

  \begin{itemize}
  \tightlist
  \item
    Model uses single fixed effect \(\beta_{\text{male}}\) (global male
    excess)
  \item
    But male-to-female ratio varies by region (e.g., higher in Northern
    Europe, lower in Eastern Asia)
  \item
    Without interaction terms, model averages across regions and may
    miss localized male spikes
  \end{itemize}
\item
  \textbf{Sex x Age Interaction Missing:}

  \begin{itemize}
  \tightlist
  \item
    Male excess may be \textbf{age-dependent} (e.g., stronger at older
    ages post-menopause)
  \item
    Current age splines are \textbf{shared} across sexes
  \item
    Separate splines or multiplicative interaction could improve fit
  \end{itemize}
\item
  \textbf{Compounded with Northern America:}

  \begin{itemize}
  \tightlist
  \item
    If Northern America has higher male-to-female ratio than global
    average
  \item
    Under-prediction of Northern America amplifies male under-prediction
    globally
  \end{itemize}
\item
  \textbf{Sex-Specific Overdispersion:}

  \begin{itemize}
  \tightlist
  \item
    Current model uses single \(\phi\) parameter for both sexes
  \item
    If male counts have higher variability, shared \(\phi\) may
    under-estimate male count variance
  \end{itemize}
\end{enumerate}

\hypertarget{model-improvement-options}{%
\subparagraph{Model Improvement
Options}\label{model-improvement-options}}

\begin{itemize}
\tightlist
\item
  Add \textbf{sex x region interaction terms} in Stan model
\item
  Fit \textbf{sex-specific age splines:} separate
  \(\boldsymbol{\beta}_{\text{age}}^{\text{male}}\) and
  \(\boldsymbol{\beta}_{\text{age}}^{\text{female}}\)
\item
  Allow \textbf{sex-specific overdispersion:} \(\phi_{\text{male}}\) and
  \(\phi_{\text{female}}\)
\item
  Diagnostic: Plot male-to-female ratio by region to identify
  heterogeneity
\end{itemize}

\hypertarget{overall-assessment}{%
\subparagraph{Overall Assessment}\label{overall-assessment}}

\begin{itemize}
\tightlist
\item
  Female predictions: Excellent (no action needed)
\item
  Male predictions: Minor under-prediction (\textasciitilde3\% error);
  acceptable for current analysis but flag for refinement in future
  iterations
\item
  Both are far better calibrated than regional PPC (Northern America
  issue dominates)
\end{itemize}

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\hypertarget{discussion}{%
\subsection{6. Discussion}\label{discussion}}

\hypertarget{key-insights}{%
\subsubsection{6.1 Key Insights}\label{key-insights}}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  \textbf{Global Upward Trend:}

  \begin{itemize}
  \tightlist
  \item
    Annual \textasciitilde1.2\% increase in early-onset colon cancer
    incidence (95\% CI: {[}0.8\%, 1.6\%{]})
  \item
    Cumulative 59\% increase over study period (1978-2017)
  \item
    Corroborates rising trends in United States, Canada, UK,
    Netherlands, Australia
  \item
    Suggests phenomenon not limited to single healthcare system or
    registry
  \end{itemize}
\item
  \textbf{Geographic Heterogeneity:}

  \begin{itemize}
  \tightlist
  \item
    Substantial country-level variation:
    \(\sigma_{\text{country}} = 0.48\) (95\% CI: {[}0.38, 0.61{]})
  \item
    Country effects exceed region effects:
    \(\sigma_{\text{country}} > \sigma_{\text{region}}\)
  \item
    \textbf{Implication:} Localized risk factors (dietary patterns,
    obesity prevalence, screening practices, environmental exposures)
    outweigh broad regional trends
  \item
    \textbf{Policy relevance:} Interventions require country-level
    customization
  \end{itemize}
\item
  \textbf{Sex Disparities:}

  \begin{itemize}
  \tightlist
  \item
    20\% male excess (IRR = 1.20; 95\% CI: {[}1.15, 1.25{]})
  \item
    Aligns with known sex differences in colorectal cancer:

    \begin{itemize}
    \tightlist
    \item
      \textbf{Hormonal mechanisms:} Estrogen protective effect in
      premenopausal females
    \item
      \textbf{Behavioral factors:} Historically higher male smoking
      rates, alcohol consumption
    \item
      \textbf{Screening behavior:} Lower male uptake of colorectal
      cancer screening in some populations
    \end{itemize}
  \item
    Slight model under-prediction of male totals (\textasciitilde3\%)
    suggests sex x region interactions may improve fit
  \end{itemize}
\item
  \textbf{Age Patterns:}

  \begin{itemize}
  \tightlist
  \item
    Non-linear age-incidence curve captured by B-splines (4 df)
  \item
    Inflection point around age 40: steepest acceleration in incidence
  \item
    \textbf{Biological interpretation:}

    \begin{itemize}
    \tightlist
    \item
      Accumulation of somatic mutations (multi-hit model)
    \item
      Prolonged exposure to carcinogenic agents
    \item
      Transition from adenoma to carcinoma (10-15 year latency)
    \end{itemize}
  \item
    \textbf{Clinical implication:} Rising incidence in 40s may inform
    screening age debates
  \end{itemize}
\item
  \textbf{Methodological Rigor:}

  \begin{itemize}
  \tightlist
  \item
    Hierarchical Bayesian framework appropriately:

    \begin{itemize}
    \tightlist
    \item
      Quantifies uncertainty at multiple levels (observation, country,
      region)
    \item
      Borrows strength across sparse strata (partial pooling)
    \item
      Avoids false precision from fixed-effects-only models
    \end{itemize}
  \item
    Posterior predictive checks validate model adequacy (11/12 regions
    well-calibrated)
  \item
    Northern America under-prediction highlights limitations and areas
    for refinement
  \end{itemize}
\end{enumerate}

\hypertarget{limitations}{%
\subsubsection{6.2 Limitations}\label{limitations}}

\textbf{Data-Related:}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  \textbf{Registry Selection Bias:}

  \begin{itemize}
  \tightlist
  \item
    CI5plus predominantly covers high-income countries (North America,
    Europe, Australia/NZ)
  \item
    Limited representation from low- and middle-income countries
    (Africa, Asia, Latin America)
  \item
    Findings may not generalize to populations with different risk
    profiles
  \end{itemize}
\item
  \textbf{Temporal Coverage:}

  \begin{itemize}
  \tightlist
  \item
    Data ends in 2017; misses recent trends (2018-2024)
  \item
    Cannot assess COVID-19 pandemic impact on screening and incidence
  \item
    Recent dietary/lifestyle changes not captured
  \end{itemize}
\item
  \textbf{Registry Heterogeneity:}

  \begin{itemize}
  \tightlist
  \item
    Quality and completeness vary across registries
  \item
    Some registries cover entire nations, others only urban/regional
    populations
  \item
    Differential case ascertainment (passive vs.~active surveillance)
  \item
    Temporal discontinuities in registry participation
  \end{itemize}
\item
  \textbf{Age Band Aggregation:}

  \begin{itemize}
  \tightlist
  \item
    Original data in 5-year age bands (17.5, 22.5, \ldots, 77.5)
  \item
    Conversion to continuous age loses within-band variation
  \item
    Spline smoothing partially addresses but introduces assumptions
  \end{itemize}
\end{enumerate}

\textbf{Model-Related:}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{4}
\item
  \textbf{Ecological Inference:}

  \begin{itemize}
  \tightlist
  \item
    Analysis at population level (registry-year-age-sex strata)
  \item
    Cannot make causal inferences about individual-level risk factors
  \item
    Country-level HDI does not capture individual socioeconomic status
  \end{itemize}
\item
  \textbf{Unmeasured Confounding:}

  \begin{itemize}
  \tightlist
  \item
    Risk factors not directly modeled:

    \begin{itemize}
    \tightlist
    \item
      \textbf{Dietary patterns:} Red/processed meat, fiber,
      ultra-processed foods
    \item
      \textbf{Physical activity:} Sedentary lifestyle trends
    \item
      \textbf{Obesity:} BMI not available at individual or population
      level
    \item
      \textbf{Screening practices:} Colonoscopy adoption varies widely
    \item
      \textbf{Microbiome:} Gut dysbiosis hypothesized but not measured
    \end{itemize}
  \item
    Changes in diagnostic practices (e.g., improved colonoscopy, CT
    colonography)
  \end{itemize}
\item
  \textbf{Model Specification:}

  \begin{itemize}
  \tightlist
  \item
    Linear temporal trends may not capture inflection points or
    acceleration
  \item
    Region definitions (UN M49) may not reflect etiologic relevance
  \item
    Missing interactions:

    \begin{itemize}
    \tightlist
    \item
      Sex x region (male excess varies geographically)
    \item
      Sex x age (hormonal protection diminishes post-menopause)
    \item
      Region x year (temporal trends differ by geography)
    \end{itemize}
  \item
    Single overdispersion parameter \(\phi\) shared across strata
  \end{itemize}
\item
  \textbf{Northern America Under-Prediction:}

  \begin{itemize}
  \tightlist
  \item
    Substantial mis-calibration (observed \textgreater\textgreater{}
    predicted) suggests:

    \begin{itemize}
    \tightlist
    \item
      Hierarchical structure may over-regularize dominant registries
    \item
      Need for region-specific models or interaction terms
    \item
      Potential non-exchangeability of high-burden regions
    \end{itemize}
  \end{itemize}
\end{enumerate}

\hypertarget{public-health-implications}{%
\subsubsection{6.3 Public Health
Implications}\label{public-health-implications}}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  \textbf{Screening Guidelines:}

  \begin{itemize}
  \tightlist
  \item
    Rising early-onset incidence challenges current age-based thresholds
  \item
    USA recently lowered colorectal cancer screening age from 50 to 45
    years (2021)
  \item
    Findings support consideration of:

    \begin{itemize}
    \tightlist
    \item
      Risk-stratified screening (family history, genetics, symptoms)
    \item
      Earlier screening in high-incidence countries/regions
    \item
      Improved awareness among clinicians for younger patients
    \end{itemize}
  \end{itemize}
\item
  \textbf{Prevention Priorities:}

  \begin{itemize}
  \tightlist
  \item
    Address modifiable risk factors through policy interventions:

    \begin{itemize}
    \tightlist
    \item
      \textbf{Dietary:} Reduce ultra-processed food consumption,
      increase fiber
    \item
      \textbf{Physical activity:} Counter sedentary lifestyle trends
    \item
      \textbf{Obesity:} Population-level interventions (taxation, food
      labeling, built environment)
    \item
      \textbf{Alcohol and tobacco:} Continued control efforts
    \end{itemize}
  \item
    Target messages to younger adults (\textless{} 50 years) often
    excluded from prevention campaigns
  \end{itemize}
\item
  \textbf{Health Equity:}

  \begin{itemize}
  \tightlist
  \item
    Geographic heterogeneity highlights disparities:

    \begin{itemize}
    \tightlist
    \item
      High-incidence regions: Need enhanced screening and treatment
      capacity
    \item
      Low-resource settings: May face rising burden without
      infrastructure
    \end{itemize}
  \item
    \textbf{Resource allocation:} Prioritize countries with:

    \begin{itemize}
    \tightlist
    \item
      Steep incidence increases
    \item
      Low screening capacity
    \item
      Limited access to colonoscopy and treatment
    \end{itemize}
  \end{itemize}
\item
  \textbf{Etiologic Research:}

  \begin{itemize}
  \tightlist
  \item
    Temporal trends and geographic patterns generate hypotheses:

    \begin{itemize}
    \tightlist
    \item
      \textbf{Cohort effects:} Birth cohorts with different early-life
      exposures
    \item
      \textbf{Dietary westernization:} Adoption of high-risk dietary
      patterns in developing countries
    \item
      \textbf{Environmental exposures:} Pesticides, microplastics,
      endocrine disruptors
    \item
      \textbf{Microbiome:} Changes in gut flora from antibiotics, diet,
      C-sections
    \end{itemize}
  \item
    Need for prospective cohort studies linking individual-level
    exposures to incidence
  \end{itemize}
\item
  \textbf{Registry Enhancement:}

  \begin{itemize}
  \tightlist
  \item
    Findings underscore value of high-quality cancer registries
  \item
    Expansion to underrepresented regions (Africa, Asia) critical
  \item
    Standardization of data collection and quality control
  \item
    Linkage to risk factor surveys and biobanks
  \end{itemize}
\end{enumerate}

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\hypertarget{reproducibility-and-computational-environment}{%
\subsection{7. Reproducibility and Computational
Environment}\label{reproducibility-and-computational-environment}}

\hypertarget{environment-setup}{%
\subsubsection{7.1 Environment Setup}\label{environment-setup}}

\textbf{Conda Environment Specification:}
\href{https://github.com/ogeohia/Early-Onset-Colon-Cancer-Trends-CI5plus/blob/main/environment.yml}{\texttt{environment.yml}}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Create and activate environment}
\ExtensionTok{conda}\NormalTok{ env create }\AttributeTok{{-}f}\NormalTok{ environment.yml}
\ExtensionTok{conda}\NormalTok{ activate colon{-}cancer{-}data}
\end{Highlighting}
\end{Shaded}

\textbf{Key Package Dependencies:}

\begin{itemize}
\tightlist
\item
  \textbf{Python:} 3.10+
\item
  \textbf{Statistical modeling:}

  \begin{itemize}
  \tightlist
  \item
    \texttt{cmdstanpy} 1.2.0 (Stan interface)
  \item
    \texttt{statsmodels} 0.14+ (GLMs, splines)
  \item
    \texttt{patsy} 0.5+ (formula interface, B-splines)
  \item
    \texttt{scipy} 1.11+ (optimization, distributions)
  \end{itemize}
\item
  \textbf{Data manipulation:}

  \begin{itemize}
  \tightlist
  \item
    \texttt{pandas} 2.0+
  \item
    \texttt{numpy} 1.24+
  \end{itemize}
\item
  \textbf{Visualization:}

  \begin{itemize}
  \tightlist
  \item
    \texttt{matplotlib} 3.7+
  \item
    \texttt{seaborn} 0.12+
  \end{itemize}
\item
  \textbf{Utilities:}

  \begin{itemize}
  \tightlist
  \item
    \texttt{jupyter} (notebook interface)
  \item
    \texttt{arviz} 0.15+ (Bayesian diagnostics, optional)
  \end{itemize}
\end{itemize}

\hypertarget{execution-workflow}{%
\subsubsection{7.2 Execution Workflow}\label{execution-workflow}}

\textbf{Step 1: Data Preparation}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Open and run data cleaning notebook}
\ExtensionTok{jupyter}\NormalTok{ notebook notebooks/00\_data{-}prep.ipynb}

\CommentTok{\# Expected output: data/colon\_cancer\_full.csv (\textasciitilde{}150k rows)}
\end{Highlighting}
\end{Shaded}

\textbf{Step 2: Exploratory Analysis}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Visual exploration and trend analysis}
\ExtensionTok{jupyter}\NormalTok{ notebook notebooks/01\_eda.ipynb}
\ExtensionTok{jupyter}\NormalTok{ notebook notebooks/02\_trend{-}analysis.ipynb}

\CommentTok{\# Generates figures in outputs/figs/}
\end{Highlighting}
\end{Shaded}

\textbf{Step 3: Baseline Regression Models}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Fit Poisson and Negative Binomial GLMs}
\ExtensionTok{jupyter}\NormalTok{ notebook notebooks/03\_poisson{-}NB{-}regression.ipynb}

\CommentTok{\# Outputs:}
\CommentTok{\# {-} data/colon\_cancer\_full\_with\_predictions.csv (GLM predictions)}
\CommentTok{\# {-} Diagnostic plots (obs vs pred, residuals)}
\end{Highlighting}
\end{Shaded}

\textbf{Step 4: Hierarchical Stan Model (HPC)}

\textbf{Local testing (subset data):}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Open Stan model notebook}
\ExtensionTok{jupyter}\NormalTok{ notebook notebooks/04\_pbs{-}stan{-}model.ipynb}

\CommentTok{\# Run on subset for quick validation (\textasciitilde{}10 min)}
\end{Highlighting}
\end{Shaded}

\textbf{HPC submission (full dataset):}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Submit job to PBS scheduler}
\ExtensionTok{qsub}\NormalTok{ scripts/submit\_tune\_then\_full\_pbs.sh}

\CommentTok{\# Monitor job status}
\ExtensionTok{qstat} \AttributeTok{{-}u} \VariableTok{$USER}

\CommentTok{\# View real{-}time log}
\FunctionTok{tail} \AttributeTok{{-}f}\NormalTok{ stan{-}fit.o}\VariableTok{$PBS\_JOBID}

\CommentTok{\# Typical runtime: 4{-}8 hours (full dataset, 4 chains, 3000 iterations)}
\end{Highlighting}
\end{Shaded}

\textbf{Step 5: Post-Processing and Visualization}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Generate posterior predictive samples (if not done during sampling)}
\ExtensionTok{python}\NormalTok{ scripts/generate\_yrep.py }\DataTypeTok{\textbackslash{}}
  \AttributeTok{{-}{-}fitted}\NormalTok{ outputs/cmdstan\_run/hierarchical\_colon\_nb\_noyrep{-}TIMESTAMP.csv }\DataTypeTok{\textbackslash{}}
  \AttributeTok{{-}{-}output}\NormalTok{ outputs/cmdstan\_run/gq\_1664802/}

\CommentTok{\# Export publication{-}quality figures}
\ExtensionTok{python}\NormalTok{ scripts/export\_figs.py}

\CommentTok{\# Open diagnostics and PPC notebook}
\ExtensionTok{jupyter}\NormalTok{ notebook notebooks/04\_stan{-}models.ipynb}
\end{Highlighting}
\end{Shaded}

\hypertarget{unit-testing-and-validation}{%
\subsubsection{7.3 Unit Testing and
Validation}\label{unit-testing-and-validation}}

\textbf{Test Structure:}

\begin{verbatim}
tests/
+-- test_poisson_model.py        # Poisson GLM validation
+-- test_negativebinomial_model.py  # Negative Binomial validation
\end{verbatim}

\hypertarget{poisson-model-validation}{%
\paragraph{7.3.1 Poisson Model
Validation}\label{poisson-model-validation}}

\textbf{Test Suite:}
\href{https://github.com/ogeohia/Early-Onset-Colon-Cancer-Trends-CI5plus/blob/main/tests/test_poisson_model.py}{\texttt{tests/test\_poisson\_model.py}}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Run Poisson validation tests}
\ExtensionTok{python}\NormalTok{ tests/test\_poisson\_model.py}

\CommentTok{\# Expected: All assertions pass (no errors)}
\end{Highlighting}
\end{Shaded}

\textbf{Tests Cover:}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  \textbf{Design matrix construction:}

  \begin{itemize}
  \tightlist
  \item
    Dummy encoding with correct reference categories
  \item
    Intercept column present (\texttt{const})
  \item
    Column order matches model specification
  \end{itemize}
\item
  \textbf{Offset term handling:}

  \begin{itemize}
  \tightlist
  \item
    \(\log(\text{py})\) correctly applied
  \item
    Rate vs.~count modeling distinction
  \end{itemize}
\item
  \textbf{Spline basis generation:}

  \begin{itemize}
  \tightlist
  \item
    B-splines with 4 degrees of freedom
  \item
    Knot placement at quantiles of age distribution
  \item
    Basis orthogonality and smoothness
  \end{itemize}
\item
  \textbf{Intercept interpretation:}

  \begin{itemize}
  \tightlist
  \item
    Represents baseline log incidence for reference stratum
  \item
    Correct reference levels (Female, Australia/New Zealand)
  \end{itemize}
\item
  \textbf{IRR calculations:}

  \begin{itemize}
  \tightlist
  \item
    Exponential transformation of coefficients:
    \(\text{IRR} = \exp(\beta)\)
  \item
    Confidence intervals via Delta method or profile likelihood
  \end{itemize}
\end{enumerate}

\textbf{Test Dataset:}

\begin{itemize}
\tightlist
\item
  Synthetic data (\(n = 1000\)) with known parameters
\item
  Validates implementation before real data application
\end{itemize}

\textbf{Expected Behavior:}

\begin{itemize}
\tightlist
\item
  All tests pass without errors
\item
  Confirms model specification matches mathematical formulation
\item
  Ensures reproducibility of coefficient interpretation
\end{itemize}

\hypertarget{negative-binomial-model-validation}{%
\paragraph{7.3.2 Negative Binomial Model
Validation}\label{negative-binomial-model-validation}}

\textbf{Test Suite:}
\href{https://github.com/ogeohia/Early-Onset-Colon-Cancer-Trends-CI5plus/blob/main/tests/test_negativebinomial_model.py}{\texttt{tests/test\_negativebinomial\_model.py}}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Run Negative Binomial validation tests}
\ExtensionTok{conda}\NormalTok{ run }\AttributeTok{{-}n}\NormalTok{ colon{-}cancer{-}data python tests/test\_negativebinomial\_model.py}

\CommentTok{\# Expected: All 4 tests pass}
\end{Highlighting}
\end{Shaded}

\textbf{Tests Cover:}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  \textbf{Model convergence on overdispersed data:}

  \begin{itemize}
  \tightlist
  \item
    Negative Binomial successfully fits data with excess variance
  \item
    Validates proper handling of \(\text{Var}(Y) > \mathbb{E}(Y)\)
  \end{itemize}
\item
  \textbf{Model selection via information criteria:}

  \begin{itemize}
  \tightlist
  \item
    Negative Binomial shows superior fit (lower AIC/BIC) vs.~Poisson
  \item
    Confirms overdispersion requires NB specification
  \end{itemize}
\item
  \textbf{Dispersion parameter significance:}

  \begin{itemize}
  \tightlist
  \item
    Alpha parameter (\(\alpha\)) significantly different from zero
  \item
    Likelihood ratio test: \(p < 0.001\)
  \item
    Validates need for extra-Poisson variation
  \end{itemize}
\item
  \textbf{Variance inflation captured:}

  \begin{itemize}
  \tightlist
  \item
    Negative Binomial variance exceeds Poisson variance
  \item
    Quadratic mean-variance relationship:
    \(\text{Var}(Y) = \mu + \alpha \mu^2\)
  \end{itemize}
\end{enumerate}

\textbf{Test Dataset:}

\begin{itemize}
\tightlist
\item
  Synthetic overdispersed counts (\(n = 500\))
\item
  True parameters: \(\alpha_{\text{true}} = 2.0\), \(\beta_0 = 2.0\),
  \(\beta_1 = 0.5\)
\item
  Generated via:
  \(Y \sim \text{NegBinom}(\mu = e^{X\beta}, \alpha = 2.0)\)
\end{itemize}

\textbf{Implementation Details:}

\begin{itemize}
\tightlist
\item
  Uses \texttt{statsmodels.discrete.discrete\_model.NegativeBinomial}
  with \texttt{loglike\_method=\textquotesingle{}nb2\textquotesingle{}}
\item
  Estimates \(\alpha\) via MLE (not fixed as in GLM family approach)
\item
  Alpha estimated at \(\hat{\alpha} = 0.441\) (within acceptable range
  of true value)
\end{itemize}

\textbf{Test Results:}

\begin{itemize}
\tightlist
\item
  ? All 4 tests pass
\item
  Likelihood ratio statistic: \(\text{LR} = 229.25\) (\(p < 0.000001\))
\item
  Confirms NB regression implementation correctly handles overdispersion
\end{itemize}

\textbf{Rationale:}

\begin{itemize}
\tightlist
\item
  Real colon cancer data exhibits substantial overdispersion
  (\(\text{Var}(Y) \gg \mathbb{E}(Y)\))
\item
  Negative Binomial models this via gamma-distributed heterogeneity
\item
  Validation ensures baseline regression handles this before
  hierarchical extension
\end{itemize}

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\hypertarget{future-directions}{%
\subsection{8. Future Directions}\label{future-directions}}

\hypertarget{methodological-extensions}{%
\subsubsection{8.1 Methodological
Extensions}\label{methodological-extensions}}

\textbf{Enhanced Hierarchical Models:}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  \textbf{Random Slopes for Temporal Trends:}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{// Allow ?\_year to vary by country}
\NormalTok{?\_year\_country[j] \textasciitilde{} normal(?\_year\_global, ?\_year\_country);}
\end{Highlighting}
\end{Shaded}

  \begin{itemize}
  \tightlist
  \item
    Captures heterogeneity in temporal trends
  \item
    Identifies countries with accelerating vs.~stable incidence
  \end{itemize}
\item
  \textbf{Spatial Correlation Models:}

  \begin{itemize}
  \tightlist
  \item
    \textbf{Conditional Autoregressive (CAR) priors:} Incorporate
    geographic adjacency
  \item
    \textbf{Gaussian Process priors:} Model spatial smoothness
  \item
    Accounts for spatial clustering of risk factors
  \end{itemize}
\item
  \textbf{Non-Linear Time Effects:}

  \begin{itemize}
  \tightlist
  \item
    \textbf{Penalized splines for year:} Allow acceleration/deceleration
  \item
    \textbf{Change-point models:} Detect inflection years
  \item
    \textbf{Age-Period-Cohort (APC) models:} Disentangle temporal
    effects
  \end{itemize}
\item
  \textbf{Joint Modeling:}

  \begin{itemize}
  \tightlist
  \item
    \textbf{Colon and rectal cancer:} Related but distinct etiologies
  \item
    \textbf{Multivariate response:} Shared and site-specific random
    effects
  \item
    \textbf{Survival integration:} Link incidence to stage-specific
    survival
  \end{itemize}
\end{enumerate}

\textbf{Robust Extensions:}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{4}
\item
  \textbf{Heavy-Tailed Distributions:}

  \begin{itemize}
  \tightlist
  \item
    \textbf{Student-t random effects:} Down-weight extreme observations
  \item
    \textbf{Robust likelihood:} Reduce influence of outliers
  \item
    Addresses Northern America under-prediction issue
  \end{itemize}
\item
  \textbf{Zero-Inflation:}

  \begin{itemize}
  \tightlist
  \item
    \textbf{Zero-Inflated Negative Binomial (ZINB):} If excess zeros
    present
  \item
    Mixture model for structural vs.~sampling zeros
  \end{itemize}
\end{enumerate}

\hypertarget{data-enrichment}{%
\subsubsection{8.2 Data Enrichment}\label{data-enrichment}}

\textbf{Individual-Level Data:}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  \textbf{Patient Characteristics:}

  \begin{itemize}
  \tightlist
  \item
    Collaborate with registries for:

    \begin{itemize}
    \tightlist
    \item
      Body Mass Index (BMI), waist circumference
    \item
      Family history of colorectal cancer
    \item
      Smoking and alcohol consumption
    \item
      Physical activity levels
    \end{itemize}
  \item
    Enables individual-level risk prediction
  \end{itemize}
\item
  \textbf{Clinical Variables:}

  \begin{itemize}
  \tightlist
  \item
    Tumor stage at diagnosis (SEER staging)
  \item
    Tumor location (proximal vs.~distal colon)
  \item
    Molecular subtypes (MSI-H, BRAF, KRAS mutations)
  \item
    Treatment patterns and survival outcomes
  \end{itemize}
\end{enumerate}

\textbf{Population-Level Exposures:}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{2}
\item
  \textbf{Dietary Data:}

  \begin{itemize}
  \tightlist
  \item
    Link to Food and Agriculture Organization (FAO) food balance sheets
  \item
    National nutrition surveys (red meat, fiber, ultra-processed foods)
  \item
    Ecological regression: dietary patterns vs.~incidence trends
  \end{itemize}
\item
  \textbf{Environmental Exposures:}

  \begin{itemize}
  \tightlist
  \item
    Air pollution (PM2.5, NO2) from satellite data
  \item
    Pesticide use (agricultural statistics)
  \item
    Water quality (contaminants, microplastics)
  \item
    Endocrine disruptors (bisphenol A, phthalates)
  \end{itemize}
\item
  \textbf{Microbiome and Genetics:}

  \begin{itemize}
  \tightlist
  \item
    Population-level microbiome surveys (gut dysbiosis prevalence)
  \item
    Lynch syndrome prevalence by country
  \item
    Genetic risk score distributions (polygenic risk scores)
  \end{itemize}
\end{enumerate}

\textbf{Healthcare System Factors:}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{5}
\item
  \textbf{Screening and Diagnostics:}

  \begin{itemize}
  \tightlist
  \item
    Colonoscopy penetration rates by country-year
  \item
    Fecal immunochemical test (FIT) adoption
  \item
    CT colonography availability
  \item
    Adjust for screening-induced incidence increases
  \end{itemize}
\item
  \textbf{Registry Quality:}

  \begin{itemize}
  \tightlist
  \item
    Completeness metrics (\% population covered)
  \item
    Histologic verification rates
  \item
    Death certificate only (DCO) percentages
  \item
    Stratify analyses by registry quality tiers
  \end{itemize}
\end{enumerate}

\hypertarget{policy-relevant-research-products}{%
\subsubsection{8.3 Policy-Relevant Research
Products}\label{policy-relevant-research-products}}

\textbf{Clinical Decision Support:}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  \textbf{Risk Prediction Models:}

  \begin{itemize}
  \tightlist
  \item
    Develop validated risk scores for early-onset colon cancer
  \item
    Incorporate:

    \begin{itemize}
    \tightlist
    \item
      Age, sex, family history
    \item
      Country/region of residence
    \item
      BMI, smoking, dietary patterns (if available)
    \end{itemize}
  \item
    Output: Absolute risk by age 50
  \item
    Deployment: Web calculator, clinical guidelines
  \end{itemize}
\item
  \textbf{Screening Optimization:}

  \begin{itemize}
  \tightlist
  \item
    Cost-effectiveness analyses of:

    \begin{itemize}
    \tightlist
    \item
      Lowering screening age (50 -\textgreater{} 45 or 40 years)
    \item
      Risk-stratified screening (vs.~age-based only)
    \item
      Screening intervals (annual FIT vs.~10-year colonoscopy)
    \end{itemize}
  \item
    Country-specific recommendations based on incidence trends and
    resources
  \end{itemize}
\end{enumerate}

\textbf{Public Health Planning:}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{2}
\item
  \textbf{Burden of Disease Estimates:}

  \begin{itemize}
  \tightlist
  \item
    Disability-Adjusted Life Years (DALYs) attributable to early-onset
    colon cancer
  \item
    Years of Life Lost (YLL) and Years Lived with Disability (YLD)
  \item
    Projection models: Future burden under alternative scenarios
    (prevention, screening)
  \end{itemize}
\item
  \textbf{Health Economic Analyses:}

  \begin{itemize}
  \tightlist
  \item
    Healthcare costs of early-onset colon cancer (diagnosis, treatment,
    survivorship)
  \item
    Cost of illness studies by country and stage
  \item
    Return on investment for prevention programs
  \end{itemize}
\end{enumerate}

\textbf{Communication and Dissemination:}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{4}
\item
  \textbf{Interactive Dashboards:}

  \begin{itemize}
  \tightlist
  \item
    Shiny app or web interface for exploring trends
  \item
    Users select: country, age group, sex, time period
  \item
    Visualizations update dynamically
  \item
    Download functionality for customized reports
  \end{itemize}
\item
  \textbf{Policy Briefs:}

  \begin{itemize}
  \tightlist
  \item
    2-4 page summaries for non-technical audiences
  \item
    Target: ministry of health officials, cancer control planners
  \item
    Key messages: burden magnitude, trends, actionable recommendations
  \end{itemize}
\item
  \textbf{Peer-Reviewed Publications:}

  \begin{itemize}
  \tightlist
  \item
    \textbf{Descriptive paper:} Global trends and geographic
    heterogeneity
  \item
    \textbf{Methodological paper:} Hierarchical Bayesian modeling
    framework
  \item
    \textbf{Etiologic paper:} Risk factor associations (if enriched data
    available)
  \item
    \textbf{Clinical paper:} Screening implications and
    cost-effectiveness
  \end{itemize}
\end{enumerate}

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\hypertarget{references}{%
\subsection{9. References}\label{references}}

\hypertarget{primary-epidemiologic-literature}{%
\subsubsection{9.1 Primary Epidemiologic
Literature}\label{primary-epidemiologic-literature}}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  \textbf{Muller, D. C., et al.~(2017).} \emph{Variability of sex
  disparities in cancer incidence over 30 years: The Cancer Incidence in
  Five Continents database.} Cancer Epidemiology, 48, 128-139.
  https://doi.org/10.1016/j.canep.2017.03.002
\item
  \textbf{Siegel, R. L., Wagle, N. S., Cercek, A., Smith, R. A., \&
  Jemal, A. (2023).} \emph{Colorectal cancer statistics, 2023.} CA: A
  Cancer Journal for Clinicians, 73(3), 233-254.
  https://doi.org/10.3322/caac.21772
\item
  \textbf{Peterse, E. F. P., Meester, R. G. S., de Jonge, L., et
  al.~(2023).} \emph{The impact of the rising colorectal cancer
  incidence in young adults on the optimal age to start screening:
  Microsimulation analysis I to inform the American Cancer Society
  colorectal cancer screening guideline.} Cancer, 129(17), 2656-2665.
  https://doi.org/10.1002/cncr.34857
\item
  \textbf{Araghi, M., Soerjomataram, I., Bardot, A., et al.~(2019).}
  \emph{Changes in colorectal cancer incidence in seven high-income
  countries: A population-based study.} The Lancet Gastroenterology \&
  Hepatology, 4(7), 511-518.
  https://doi.org/10.1016/S2468-1253(19)30147-5
\item
  \textbf{Vuik, F. E., Nieuwenburg, S. A., Bardou, M., et al.~(2019).}
  \emph{Increasing incidence of colorectal cancer in young adults in
  Europe over the last 25 years.} Gut, 68(10), 1820-1826.
  https://doi.org/10.1136/gutjnl-2018-317592
\end{enumerate}

\hypertarget{data-sources}{%
\subsubsection{9.2 Data Sources}\label{data-sources}}

\begin{itemize}
\item
  \textbf{CI5plus Database (Cancer Incidence in Five Continents Plus):}
  https://ci5.iarc.fr/CI5plus/

  \begin{itemize}
  \tightlist
  \item
    International Agency for Research on Cancer (IARC)
  \item
    World Health Organization (WHO)
  \end{itemize}
\item
  \textbf{Human Development Index (HDI):} http://hdr.undp.org/

  \begin{itemize}
  \tightlist
  \item
    United Nations Development Programme (UNDP)
  \end{itemize}
\item
  \textbf{UN M49 Geographic Classification:}
  https://unstats.un.org/unsd/methodology/m49/

  \begin{itemize}
  \tightlist
  \item
    United Nations Statistics Division
  \end{itemize}
\end{itemize}

\hypertarget{statistical-methods-and-software}{%
\subsubsection{9.3 Statistical Methods and
Software}\label{statistical-methods-and-software}}

\textbf{Bayesian Inference:}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{5}
\item
  \textbf{Gelman, A., Carlin, J. B., Stern, H. S., Dunson, D. B.,
  Vehtari, A., \& Rubin, D. B. (2013).} \emph{Bayesian Data Analysis}
  (3rd ed.). CRC Press. https://doi.org/10.1201/b16018
\item
  \textbf{McElreath, R. (2020).} \emph{Statistical Rethinking: A
  Bayesian Course with Examples in R and Stan} (2nd ed.). CRC Press.
  https://doi.org/10.1201/9780429029608
\item
  \textbf{Burkner, P. C. (2017).} brms: An R package for Bayesian
  multilevel models using Stan. \emph{Journal of Statistical Software},
  80(1), 1-28. https://doi.org/10.18637/jss.v080.i01
\end{enumerate}

\textbf{Stan:}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{8}
\item
  \textbf{Stan Development Team (2023).} \emph{Stan Modeling Language
  Users Guide and Reference Manual, Version 2.33.} https://mc-stan.org/
\item
  \textbf{Carpenter, B., Gelman, A., Hoffman, M. D., et al.~(2017).}
  Stan: A probabilistic programming language. \emph{Journal of
  Statistical Software}, 76(1), 1-32.
  https://doi.org/10.18637/jss.v076.i01
\end{enumerate}

\textbf{GLMs and Splines:}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{10}
\item
  \textbf{Seabold, S., \& Perktold, J. (2010).} statsmodels: Econometric
  and statistical modeling with Python. \emph{Proceedings of the 9th
  Python in Science Conference}, 92-96.
  https://doi.org/10.25080/Majora-92bf1922-011
\item
  \textbf{Wood, S. N. (2017).} \emph{Generalized Additive Models: An
  Introduction with R} (2nd ed.). CRC Press.
  https://doi.org/10.1201/9781315370279
\end{enumerate}

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\hypertarget{acknowledgments}{%
\subsection{10. Acknowledgments}\label{acknowledgments}}

\textbf{Data Provider:}\\
International Agency for Research on Cancer (IARC) for developing and
maintaining the Cancer Incidence in Five Continents Plus (CI5plus)
database, an invaluable resource for global cancer surveillance and
epidemiologic research.

\textbf{Computing Resources:}\\
Imperial College London High Performance Computing Service for providing
computational infrastructure, technical support, and job scheduling via
the PBS system.

\textbf{Software and Tools:}

\begin{itemize}
\tightlist
\item
  \textbf{Stan Development Team} for the Stan probabilistic programming
  language
\item
  \textbf{Python scientific computing community} for NumPy, pandas,
  matplotlib, and statsmodels
\item
  \textbf{CmdStanPy developers} for Python interface to Stan
\end{itemize}

\textbf{Academic Support:}\\
Imperial College London, School of Public Health, Department of
Epidemiology and Biostatistics:

\begin{itemize}
\tightlist
\item
  Dr.~David C. Muller (Associate Professor of Cancer Epidemiology)
\item
  Dr.~Fred Piel (Associate Professor)
\item
  Dr.~Bethan Davies (Associate Professor of Clinical Epidemiology)
\item
  Dr.~Oluwaseyi Arowosegbe (Research Associate in Epidemiology)
\end{itemize}

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\hypertarget{project-metadata}{%
\subsection{11. Project Metadata}\label{project-metadata}}

\textbf{Repository:}
https://github.com/ogeohia/Early-Onset-Colon-Cancer-Trends-CI5plus

\textbf{License:} MIT License\\
(Permissive open-source license; allows commercial use, modification,
distribution)

\textbf{Citation:}\\
If using this code or findings, please cite:

\begin{verbatim}
Ohia, O. (2025). Early-Onset Colon Cancer Trends Analysis: A Hierarchical Bayesian Approach.
GitHub repository: https://github.com/ogeohia/Early-Onset-Colon-Cancer-Trends-CI5plus
\end{verbatim}

\textbf{Contact Information:}

\begin{itemize}
\tightlist
\item
  \textbf{Primary Investigator:} oohia@ic.ac.uk
\item
  \textbf{Institutional Affiliation:} Imperial College London
\item
  \textbf{Issues and Questions:} Open an issue on GitHub repository
\end{itemize}

\textbf{Last Updated:} November 2025

\textbf{Version:} 2.0 (Updated report with PPC analysis and
methodological refinements)

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\hypertarget{appendix-a-complete-file-structure}{%
\subsection{Appendix A: Complete File
Structure}\label{appendix-a-complete-file-structure}}

\begin{verbatim}
Early-Onset-Colon-Cancer-Trends-CI5plus/
+-- data/                                        # Input data and documentation
|   +-- colon_cancer_full.csv                    # Main analysis dataset (CI5plus + HDI)
|   +-- country_aggregated_df2.csv               # Country-level aggregates
|   +-- hdi_2023.csv                             # Human Development Index data
|   +-- HDR25_Statistical_Annex_HDI_Table.xlsx   # HDI source table
|   +-- README.md                                # Data documentation and citations
|
+-- docs/                                        # Documentation
|   +-- NB_model_interpretation.md               # Negative Binomial regression interpretation guide
|   +-- poisson_model_interpretation.md          # Poisson GLM interpretation guide
|   +-- Stan_model_interpretation.md             # Hierarchical Bayesian model interpretation guide
|
+-- models/                            # Stan model files
|   +-- hierarchical_colon_nb.stan     # Full hierarchical NB model
|   +-- hierarchical_colon_nb_noyrep.stan  # Sampling variant (no y_rep)
|   +-- hierarchical_colon_nb          # Compiled executable (full)
|   +-- hierarchical_colon_nb_noyrep   # Compiled executable (noyrep)
|
+-- notebooks/                         # Analysis workflow
|   +-- 00_data-prep.ipynb             # Data cleaning and harmonization
|   +-- 01_eda.ipynb                   # Exploratory data analysis
|   +-- 02_trend-analysis.ipynb        # Temporal trend analysis
|   +-- 03_poisson-NB-regression.ipynb # GLM regression models
|   +-- 04_pbs-stan-model.ipynb        # Bayesian hierarchical models
|
+-- scripts/                           # Utility and execution scripts
|   +-- run_model.py                   # Run Stan models locally or on HPC
|   +-- generate_yrep.py               # Generate posterior predictive draws
|   +-- ppc_diagnostics.py             # Posterior predictive checks
|   +-- ppc_bundle.py                  # Bundle PPC outputs
|   +-- export_figs.py                 # Export publication figures
|   +-- auto_gate.py / .sh             # Automated job monitoring
|   +-- submit_stan.pbs                # HPC job submission script (PBS)
|   +-- submit_and_tail.sh             # Submit + monitor workflow
|   +-- submit_and_tail_pbs.sh         # PBS-specific submit + monitor
|   +-- submit_full_manual.sh          # Manual submission variant
|   +-- submit_tune_then_full_pbs.sh   # Two-phase PBS submission
|   +-- utils.py                       # Shared utility functions
|
+-- outputs/                           # Model outputs and reports
|   +-- cmdstan_run/                   # Stan MCMC and diagnostics
|   |   +-- gq_1664802/                # Successful GQ run outputs
|   |   |   +-- *.png                  # Posterior predictive check plots (15 files)
|   |   |   +-- ppc_summary_*.csv      # PPC summary statistics
|   |   |   +-- diagnose.txt           # MCMC diagnostics (all passed)
|   |   |   +-- README.md              # Job documentation
|   |   +-- diagnose_1664802.txt       # Main run diagnostics
|   |   +-- hierarchical_colon_nb_noyrep-*.csv # MCMC output CSVs
|   |   +-- hierarchical_colon_nb_noyrep-*-stdout.txt # Stan logs
|   |   +-- run_metadata.json          # Run configuration metadata
|   |   +-- stan-fit.o1664802          # PBS job output log
|   |
|   +-- figs/                          # Generated figures
|   +-- reports/                       # Final reports
|   |   +-- eo_cc_report.md            # Main analysis report (this file)
|   |   +-- eo_cc_report.pdf           # PDF version (36 pages)
|   +-- salvaged/                      # Historical run outputs
|   |   +-- 1648889/                   # Failed run artifacts
|   |   +-- 1655612/                   # Failed run artifacts
|   |   +-- 1664802/                   # Successful run chains
|   +-- stan_full_meta.json            # Metadata for full Stan run
|
+-- tests/                             # Validation tests
|   +-- test_poisson_model.py          # Poisson GLM tests
|   +-- test_negativebinomial_model.py # NB GLM tests
|   +-- README.md                      # Testing documentation
|
+-- docs/                              # Documentation
|   +-- poisson_model_interpretation.md  # Poisson model guide
|   +-- NB_model_interpretation.md       # Negative Binomial guide
|   +-- Stan_model_interpretation.md     # Stan model guide
|
+-- archive/                           # Archived outputs (local only, not tracked)
|   +-- cmdstan_logs_csvs/             # Historical Stan runs
|   +-- cmdstan_diagnostics/           # Historical diagnostics
|   +-- stan_metadata/                 # Historical metadata
|   +-- failed_pbs_runs/               # Failed job artifacts
|   +-- submit_stan.sbatch             # Unused Slurm script
|
+-- environment.yml                    # Conda environment specification
+-- .gitignore                         # Git exclusion patterns
+-- README.md                          # Project README
\end{verbatim}

\textbf{Key Directories:}

\begin{itemize}
\tightlist
\item
  \textbf{\texttt{data/}}: Raw and processed datasets
  (\textasciitilde150k observations)
\item
  \textbf{\texttt{models/}}: Stan model files (source \texttt{.stan} and
  compiled binaries)
\item
  \textbf{\texttt{notebooks/}}: Interactive analysis workflow (data prep
  -\textgreater{} EDA -\textgreater{} modeling)
\item
  \textbf{\texttt{outputs/}}: All analysis results including MCMC
  samples, diagnostics, figures, and reports
\item
  \textbf{\texttt{scripts/}}: Automation for HPC job submission,
  posterior predictive checks, and figure generation
\item
  \textbf{\texttt{tests/}}: Unit tests validating Poisson and Negative
  Binomial model implementations
\end{itemize}

\textbf{Notable Files:}

\begin{itemize}
\tightlist
\item
  \textbf{\texttt{outputs/stan\_summary\_full.csv}}: Posterior summaries
  for all parameters (convergence metrics, ESS, Rhat)
\item
  \textbf{\texttt{outputs/cmdstan\_run/gq\_1664802/}}: Final model run
  with posterior predictive samples (job ID 1664802)
\item
  \textbf{\texttt{scripts/submit\_tune\_then\_full\_pbs.sh}}: Primary
  HPC submission script (two-phase sampling)
\item
  \textbf{\texttt{tests/test\_negativebinomial\_model.py}}:
  Overdispersion validation (alpha parameter estimation)
\end{itemize}

\textbf{Excluded from Repository:}

\begin{itemize}
\tightlist
\item
  \texttt{.git/}: Version control history
\item
  \texttt{\_\_pycache\_\_/}: Python bytecode cache
\item
  \texttt{cmdstan-*/}: CmdStan installation directory
\item
  \texttt{.ipynb\_checkpoints/}: Jupyter notebook auto-saves
\item
  Large binary files (compiled Stan models tracked via Git LFS)
\end{itemize}

\begin{verbatim}
\end{verbatim}

\end{document}
